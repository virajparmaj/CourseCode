knitr::opts_chunk$set(echo = TRUE)
# Block 1: Load required libraries
library(Seurat)
library(dplyr)
library(ggplot2)
library(patchwork)
# Block 2: Load the SOR1 Visium counts from HDF5
sor1_counts <- Read10X_h5(
"C:/Users/viraj/BuildSpace/Courses/STAT-530 Bioinformatics/A5/Data/Sample1SOR/filtered_feature_bc_matrix.h5"
)
seurat_obj <- CreateSeuratObject(counts = sor1_counts)
# Block 3: Read tissue positions and keep only in‐tissue spots
tpos <- read.csv(
"C:/Users/viraj/BuildSpace/Courses/STAT-530 Bioinformatics/A5/Data/Sample1SOR/tissue_positions_list.csv",
header = FALSE,
col.names = c("barcode","in_tissue","array_row","array_col","pxl_row","pxl_col")
)
# Filter Seurat object
valid_bcs <- tpos$barcode[tpos$in_tissue == 1]
seurat_obj <- subset(seurat_obj, cells = valid_bcs)
# Attach pixel coordinates to metadata
meta <- seurat_obj@meta.data
meta$pxl_row <- tpos$pxl_row[match(rownames(meta), tpos$barcode)]
meta$pxl_col <- tpos$pxl_col[match(rownames(meta), tpos$barcode)]
seurat_obj@meta.data <- meta
# Block 4: Add subregion labels for each barcode
# (You must have created this mapping in advance)
subreg <- read.csv(
"C:/Users/viraj/BuildSpace/Courses/STAT-530 Bioinformatics/A5/Data/Sample1SOR/subregion_map.csv"
)  # columns: barcode, subregion
seurat_obj <- AddMetaData(
seurat_obj,
metadata = setNames(subreg$subregion, subreg$barcode),
col.name = "subregion"
)
# Block 5: Subset to stratum oriens & radiatum
so <- subset(
seurat_obj,
subset = subregion %in% c("CA1_stratum_oriens","CA1_stratum_radiatum")
)
# Block 6: Normalize the data with SCTransform
so <- SCTransform(so, verbose = FALSE)
BiocManager::install("glmGamPoi")
# Block 3: Read tissue positions and keep only in‐tissue spots
tpos <- read.csv(
"C:/Users/viraj/BuildSpace/Courses/STAT-530 Bioinformatics/A5/Data/Sample1SOR/tissue_positions_list.csv",
header = FALSE,
col.names = c("barcode","in_tissue","array_row","array_col","pxl_row","pxl_col")
)
# Filter Seurat object
valid_bcs <- tpos$barcode[tpos$in_tissue == 1]
seurat_obj <- subset(seurat_obj, cells = valid_bcs)
# Attach pixel coordinates to metadata
meta <- seurat_obj@meta.data
meta$pxl_row <- tpos$pxl_row[match(rownames(meta), tpos$barcode)]
meta$pxl_col <- tpos$pxl_col[match(rownames(meta), tpos$barcode)]
seurat_obj@meta.data <- meta
# Block 4: Add subregion labels for each barcode
# (You must have created this mapping in advance)
subreg <- read.csv(
"C:/Users/viraj/BuildSpace/Courses/STAT-530 Bioinformatics/A5/Data/Sample1SOR/subregion_map.csv"
)  # columns: barcode, subregion
seurat_obj <- AddMetaData(
seurat_obj,
metadata = setNames(subreg$subregion, subreg$barcode),
col.name = "subregion"
)
# Block 5: Subset to stratum oriens & radiatum
so <- subset(
seurat_obj,
subset = subregion %in% c("CA1_stratum_oriens","CA1_stratum_radiatum")
)
install.packages("BiocManager")
BiocManager::install("glmGamPoi")
knitr::opts_chunk$set(echo = TRUE)
# Block 6: Normalize the data with SCTransform
so <- SCTransform(so, verbose = FALSE)
